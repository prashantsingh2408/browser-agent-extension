<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Assistant</title>
  <link rel="stylesheet" href="styles/sidepanel.css">
  <link rel="stylesheet" href="styles/ux-enhancements.css">
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <svg class="logo" width="24" height="24" viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
          <circle cx="9" cy="10" r="1.5" fill="currentColor"/>
          <circle cx="15" cy="10" r="1.5" fill="currentColor"/>
          <path d="M8 14c0 2.21 1.79 4 4 4s4-1.79 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <div class="header-text">
          <h1 class="app-title">AI Assistant</h1>
          <span class="status" id="status">
            <span class="status-dot"></span>
            <span id="statusText">Online</span>
          </span>
        </div>
      </div>
      <div class="header-actions">
        <button class="header-btn" id="newChatBtn" title="New chat session">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14"/>
          </svg>
        </button>
        <button class="header-btn" id="historyBtn" title="Chat history">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 3v5h5M3.05 13A9 9 0 1 0 6 5.3L3 8"/>
            <path d="M12 7v5l4 2"/>
          </svg>
        </button>
        <button class="header-btn" id="clearBtn" title="Clear current chat">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14zM10 11v6M14 11v6"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Main Navigation Tabs (Scrollable & Draggable) -->
    <div class="main-nav-container">
      <button class="nav-scroll-btn nav-scroll-left" id="navScrollLeft" style="display: none;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"/>
        </svg>
      </button>
      
      <div class="main-nav-tabs" id="mainNavTabs">
        <button class="main-nav-tab active" data-tab="chat" draggable="true">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
          </svg>
          <span class="tab-label">Chat</span>
        </button>
        <button class="main-nav-tab" data-tab="agent" draggable="true">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 6v6l4 2"/>
          </svg>
          <span class="tab-label">Hybrid Agent</span>
        </button>
        <button class="main-nav-tab" data-tab="uiux" draggable="true">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="16 18 10 12 16 6"/>
            <polyline points="8 6 2 12 8 18"/>
          </svg>
          <span class="tab-label">Web Dev</span>
        </button>
        <button class="main-nav-tab" data-tab="memory" draggable="true">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
            <path d="M9 12h6m-6 4h6"/>
          </svg>
          <span class="tab-label">Memory</span>
        </button>
        <button class="main-nav-tab" data-tab="tools" draggable="true">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
          </svg>
          <span class="tab-label">Tools</span>
        </button>
        <button class="main-nav-tab" data-tab="settings" draggable="true">
          <span class="drag-handle">‚ãÆ‚ãÆ</span>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6m4.22-13.22l4.24 4.24M18.36 18.36l4.24 4.24M23 12h-6m-6 0H1m4.22 6.36l4.24-4.24M3.54 3.54l4.24 4.24"/>
          </svg>
          <span class="tab-label">Settings</span>
        </button>
      </div>
      
      <button class="nav-scroll-btn nav-scroll-right" id="navScrollRight" style="display: none;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </button>
    </div>

    <!-- Chat Section -->
    <div class="main-tab-content" id="chatSection" style="display: flex; flex-direction: column; flex: 1;">
      <!-- Chat Tabs -->
      <div class="chat-tabs" id="chatTabs">
      <div class="tabs-container">
        <div class="tab active" data-session-id="default">
          <span class="tab-title">Chat 1</span>
          <button class="tab-close" title="Close tab">√ó</button>
        </div>
      </div>
      <button class="new-tab-btn" id="newTabBtn" title="New chat tab">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14M5 12h14"/>
        </svg>
      </button>
    </div>

    <!-- Chat History Sidebar -->
    <div class="history-sidebar" id="historySidebar">
      <div class="history-header">
        <h3>Chat History</h3>
        <button class="close-history" id="closeHistoryBtn">√ó</button>
      </div>
      <div class="history-content">
        <div class="history-search">
          <input type="text" id="historySearch" placeholder="Search chats..." />
        </div>
        <div class="history-list" id="historyList">
          <!-- History items will be populated here -->
        </div>
      </div>
    </div>

    <!-- Chat Container -->
    <div class="chat-container" id="messages">
      <!-- Welcome Message - Enhanced with UX Laws -->
      <div class="welcome-message">
        <div class="welcome-animation">
          <div class="welcome-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="10" stroke="url(#gradient)" stroke-width="1.5"/>
              <circle cx="9" cy="10" r="1.5" fill="url(#gradient)"/>
              <circle cx="15" cy="10" r="1.5" fill="url(#gradient)"/>
              <path d="M8 14c0 2.21 1.79 4 4 4s4-1.79 4-4" stroke="url(#gradient)" stroke-width="1.5" stroke-linecap="round"/>
              <defs>
                <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#4285f4;stop-opacity:1" />
                </linearGradient>
              </defs>
            </svg>
          </div>
          <div class="pulse-ring"></div>
        </div>
        <h2 class="gradient-text">Welcome to Hybrid Agent Chat</h2>
        <p class="subtitle">Hybrid AI System ‚Ä¢ Chrome Built-in AI + Fallback APIs ‚Ä¢ Always private</p>
        <div class="suggestions">
          <button class="suggestion-chip action-chip" data-action="summarize">üìÑ Summarize this page</button>
          <button class="suggestion-chip action-chip" data-action="explain-selection">üí° Explain selected text</button>
          <button class="suggestion-chip action-chip" data-action="explain-video">üé• Explain intro video</button>
          <button class="suggestion-chip" data-suggestion="What can you help me with?">‚ùì What can you do?</button>
        </div>
      </div>
    </div>

    <!-- Input Container -->
    <div class="input-container">
      <!-- Quick Action Buttons -->
      <div class="quick-actions">
        <button class="quick-action-btn" id="attachPageBtn" title="Attach current page content">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
            <polyline points="10 9 9 9 8 9"/>
          </svg>
          Attach Page
        </button>
        <button class="quick-action-btn" id="attachSelectionBtn" title="Attach selected text">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 7h16"/>
            <path d="M4 12h16"/>
            <path d="M4 17h10"/>
            <circle cx="19" cy="17" r="2"/>
          </svg>
          Selection
        </button>
        <button class="quick-action-btn" id="smartSummarizeBtn" title="Summarize selected text or page">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 11H3"/>
            <path d="M15 11h6"/>
            <path d="M12 8v8"/>
            <circle cx="12" cy="12" r="9"/>
          </svg>
          Summarize Page
        </button>
        <button class="quick-action-btn" id="translateBtn" title="Translate selected text or page to Spanish">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 8l6 6"/>
            <path d="M4 14l6-6 2-3"/>
            <path d="M2 5h12"/>
            <path d="M7 2v3"/>
            <path d="M22 22l-5-5"/>
            <path d="M17 22l5-5"/>
          </svg>
          Translate Page
        </button>
        <button class="quick-action-btn" id="improveTextBtn" title="Improve selected text">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 20h9"/>
            <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
          </svg>
          Improve
        </button>
      </div>
      <div class="input-wrapper">
        <textarea 
          id="userInput" 
          class="input-field"
          placeholder="Type a message..."
          rows="1"></textarea>
        <button id="sendBtn" class="send-btn" disabled>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      <div class="input-footer">
        <span class="footer-text">Powered by Hybrid AI System ‚Ä¢ 100% private</span>
      </div>
    </div>
    </div> <!-- End of Chat Section -->

    <!-- Mail Compose Section - UX Laws Optimized -->
    <div class="main-tab-content" id="mailSection" style="display: none; flex-direction: column; flex: 1; overflow: hidden;">
      <div class="mail-compose-container compact optimized">
        
        <!-- Zeigarnik Effect: Show incomplete task indicator -->
        <div class="task-indicator" id="taskIndicator" style="display: none;">
          <span class="pulse-dot"></span>
          <span>Draft in progress...</span>
        </div>
        
        <!-- Serial Position Effect: Most important info at start -->
        <div class="mail-header compact">
          <h2>‚ú® Craft Mail</h2>
          <!-- Simplified progress (Occam's Razor) -->
          <div class="progress-flow">
            <span class="flow-step active">Write</span>
            <span class="flow-arrow">‚Üí</span>
            <span class="flow-step">Polish</span>
            <span class="flow-arrow">‚Üí</span>
            <span class="flow-step">Send</span>
          </div>
        </div>

        <!-- Compact Mail Form with Flow optimization -->
        <div class="mail-form compact flow-optimized">
          
          <!-- Chunking: Group related elements clearly -->
          <div class="mail-workspace">
            
            <!-- Primary Focus Area (Selective Attention) -->
            <div class="primary-focus">
              
              <!-- Input Section with Von Restorff Effect -->
              <div class="input-section highlighted">
                <label class="section-title">
                  <span class="step-number">1</span>
                  What's your message about?
                </label>
                
                <!-- Pareto Principle: Show only top 3 most-used templates -->
                <div class="top-templates">
                  <button type="button" class="template-card active" data-prompt="Follow up after meeting">
                    <span class="icon">üìß</span>
                    <span class="text">Follow-up</span>
                  </button>
                  <button type="button" class="template-card" data-prompt="Schedule meeting">
                    <span class="icon">üìÖ</span>
                    <span class="text">Meeting</span>
                  </button>
                  <button type="button" class="template-card" data-prompt="Request information">
                    <span class="icon">üìù</span>
                    <span class="text">Request</span>
                  </button>
                </div>
                
                <textarea id="mailDescription" 
                          placeholder="Describe your email in a few words..." 
                          rows="2"
                          class="focus-input"></textarea>
                
                <!-- Single primary action (Hick's Law reduction) -->
                <button class="generate-btn primary pulse" id="generateFromDescription">
                  <span class="btn-content">
                    Generate with AI
                    <span class="shortcut">‚Üµ</span>
                  </span>
                </button>
              </div>
              
              <!-- Output Section (Law of Common Region) -->
              <div class="output-section">
                <label class="section-title">
                  <span class="step-number">2</span>
                  Your Email
                </label>
                
                <!-- Subject with visual hierarchy -->
                <div class="email-preview">
                  <div class="email-field subject-field">
                    <label class="micro-label">Subject</label>
                    <input type="text" id="mailSubject" placeholder="AI will generate..." />
                  </div>
                  
                  <div class="email-field body-field">
                    <label class="micro-label">Message</label>
                    <textarea id="mailBody" 
                              placeholder="Your email will appear here..." 
                              rows="6"></textarea>
                  </div>
                </div>
                
                <!-- Choice Overload Fix: Simplified to 2 main options -->
                <div class="polish-options">
                  <button class="polish-btn" data-action="professional" title="Make Professional">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M12 2v10m0 10v-10m0 0l4-4m-4 4l-4-4"/>
                    </svg>
                    Professional
                  </button>
                  <button class="polish-btn" data-action="grammar" title="Fix Grammar">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M12 20h9M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"/>
                    </svg>
                    Fix & Polish
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Action Zone (Serial Position Effect: Important at end) -->
            <div class="action-zone">
              <!-- Peak-End Rule: Strong finish -->
              <button class="action-btn hero" id="copyMailBtn">
                <span class="btn-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2"/>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                  </svg>
                </span>
                <span class="btn-text">
                  <span class="main">Copy to Email</span>
                  <span class="sub">Gmail, Outlook, etc.</span>
                </span>
              </button>
              
              <!-- Secondary actions minimized (Fitts's Law) -->
              <div class="quick-actions">
                <button class="icon-btn" id="clearMailBtn" title="Start Over">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5 7l1 12a2 2 0 002 2h8a2 2 0 002-2l1-12M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3M10 11v6M14 11v6"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    
    <!-- Agent Section - Chat Based Interface -->
    <div class="main-tab-content" id="agentSection" style="display: none; flex-direction: column; flex: 1; overflow: hidden;">
      <div class="agent-chat-container">
        <!-- Agent Chat Header -->
        <div class="agent-chat-header">
          <div class="agent-header-left">
            <h2>AI Agent Chat</h2>
            <div class="agent-selector">
              <button class="agent-quick-select active" data-agent="auto">
                <span class="agent-icon">ü§ñ</span>
                <span>Auto</span>
              </button>
              <button class="agent-quick-select" data-agent="researcher">
                <span class="agent-icon">üîç</span>
                <span>Research</span>
              </button>
              <button class="agent-quick-select" data-agent="coder">
                <span class="agent-icon">üíª</span>
                <span>Code</span>
              </button>
              <button class="agent-quick-select" data-agent="writer">
                <span class="agent-icon">‚úçÔ∏è</span>
                <span>Write</span>
              </button>
              <button class="agent-quick-select" data-agent="analyst">
                <span class="agent-icon">üìä</span>
                <span>Analyze</span>
              </button>
            </div>
          </div>
          <div class="agent-header-right">
            <div class="agent-status-indicator">
              <span class="status-dot"></span>
              <span class="status-text">Ready</span>
            </div>
            <button class="agent-clear-btn" id="clearAgentChat" title="Clear chat">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
              </svg>
            </button>
          </div>
        </div>
        
        <!-- Agent Chat Messages -->
        <div class="agent-chat-messages" id="agentChatMessages">
          <!-- Welcome message -->
          <div class="agent-welcome-message">
            <div class="welcome-icon">ü§ñ</div>
            <h3>Welcome to AI Agent Chat</h3>
            <p>I'm your AI agent assistant. I can help you with:</p>
            <div class="agent-capabilities">
              <div class="capability">
                <span class="cap-icon">üîç</span>
                <span class="cap-text"><strong>@research</strong> - Research any topic</span>
              </div>
              <div class="capability">
                <span class="cap-icon">üíª</span>
                <span class="cap-text"><strong>@code</strong> - Write and debug code</span>
              </div>
              <div class="capability">
                <span class="cap-icon">‚úçÔ∏è</span>
                <span class="cap-text"><strong>@write</strong> - Create content</span>
              </div>
              <div class="capability">
                <span class="cap-icon">üìä</span>
                <span class="cap-text"><strong>@analyze</strong> - Analyze data</span>
              </div>
            </div>
            <p class="welcome-tip">üí° <strong>Tip:</strong> You can interrupt me anytime by clicking "Stop" or typing "stop"</p>
          </div>
        </div>
        
        <!-- Agent Input Area -->
        <div class="agent-input-area">
          <!-- Agent Working Indicator -->
          <div class="agent-working-indicator" id="agentWorkingIndicator" style="display: none;">
            <div class="working-content">
              <div class="working-spinner"></div>
              <span class="working-text">Agent is working...</span>
              <button class="interrupt-btn" id="interruptAgent">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="6" y="4" width="4" height="16"/>
                  <rect x="14" y="4" width="4" height="16"/>
                </svg>
                Stop
              </button>
            </div>
            <div class="working-steps" id="workingSteps">
              <!-- Current step will appear here -->
            </div>
          </div>
          
          <!-- Input Controls -->
          <div class="agent-input-controls">
            <div class="agent-input-wrapper">
              <textarea id="agentChatInput" 
                        placeholder="Ask me anything or use @ to select an agent (e.g., @research climate change)" 
                        rows="1"></textarea>
              <div class="agent-input-actions">
                <button class="agent-send-btn" id="sendAgentMessage" disabled>
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                  </svg>
                </button>
              </div>
            </div>
            <div class="input-hints">
              <span class="hint">Press <kbd>Enter</kbd> to send, <kbd>Shift+Enter</kbd> for new line</span>
              <span class="hint">Use <kbd>@</kbd> to mention an agent</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Web Developer Agent Section -->
    <div class="main-tab-content" id="uiuxSection" style="display: none; flex-direction: column; flex: 1; overflow: hidden;">
      <div class="webdev-container">
        <!-- Web Dev Header -->
        <div class="webdev-header">
          <h2>üöÄ Web Developer Agent</h2>
          <div class="webdev-actions">
            <button class="action-btn" id="viewLiveBtn" style="display: none;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
              </svg>
              View Live
            </button>
            <span class="status-indicator" id="webdevStatus">Ready to build</span>
          </div>
        </div>
        
        <!-- Web Dev Chat Interface -->
        <div class="webdev-workspace">
          <!-- Chat Messages -->
          <div class="webdev-chat-messages" id="webdevMessages">
            <div class="webdev-welcome">
              <!-- Aesthetic-Usability Effect: Beautiful gradient icon -->
              <div class="welcome-icon-gradient">
                <span class="welcome-icon">‚ö°</span>
              </div>
              
              <!-- Serial Position Effect: Most important info first -->
              <h3>Start Building in Seconds</h3>
              <p class="subtitle">Just describe your website in plain English</p>
              
              <!-- Fitts's Law: Large, easy-to-click cards -->
              <!-- Miller's Law: Only 4 options (within 7¬±2) -->
              <!-- Von Restorff Effect: Each card has unique color accent -->
              <div class="examples-grid">
                <div class="example-card" data-accent="startup">
                  <span class="example-icon">üöÄ</span>
                  <span class="example-title">Startup Landing</span>
                  <span class="example-text">Hero, features, pricing</span>
                </div>
                <div class="example-card" data-accent="portfolio">
                  <span class="example-icon">üé®</span>
                  <span class="example-title">Portfolio</span>
                  <span class="example-text">Projects, about, contact</span>
                </div>
                <div class="example-card" data-accent="business">
                  <span class="example-icon">üíº</span>
                  <span class="example-title">Business Site</span>
                  <span class="example-text">Services, team, testimonials</span>
                </div>
                <div class="example-card" data-accent="store">
                  <span class="example-icon">üõçÔ∏è</span>
                  <span class="example-title">Online Store</span>
                  <span class="example-text">Products, cart, checkout</span>
                </div>
              </div>
              
              <!-- Goal-Gradient Effect: Progress indicator -->
              <div class="quick-start">
                <div class="steps-indicator">
                  <div class="step active">
                    <span class="step-number">1</span>
                    <span class="step-text">Describe</span>
                  </div>
                  <div class="step-arrow">‚Üí</div>
                  <div class="step">
                    <span class="step-number">2</span>
                    <span class="step-text">Generate</span>
                  </div>
                  <div class="step-arrow">‚Üí</div>
                  <div class="step">
                    <span class="step-number">3</span>
                    <span class="step-text">Preview</span>
                  </div>
                </div>
              </div>
              
              <!-- Paradox of Active User: Immediate action prompt -->
              <!-- Cognitive Load: Simple, clear instruction -->
              <div class="instant-start">
                <p class="start-prompt">What website do you want to build?</p>
                <!-- Example that users can click to auto-fill -->
                <button class="example-prompt" id="tryExample">
                  <span class="prompt-icon">üí°</span>
                  <span>Try: "Modern landing page for a SaaS product"</span>
                </button>
              </div>
              
              <!-- Law of Common Region: Grouped help info -->
              <div class="help-region">
                <details class="help-details">
                  <summary>Need help? Click here</summary>
                  <div class="help-content">
                    <div class="capability-group">
                      <h5>I can create:</h5>
                      <span class="capability-tag">Landing Pages</span>
                      <span class="capability-tag">Portfolios</span>
                      <span class="capability-tag">Blogs</span>
                      <span class="capability-tag">Dashboards</span>
                      <span class="capability-tag">E-commerce</span>
                    </div>
                    <div class="feature-group">
                      <h5>Features:</h5>
                      <span class="feature-tag">‚ú® Responsive Design</span>
                      <span class="feature-tag">üé® Modern UI</span>
                      <span class="feature-tag">‚ö° Fast Loading</span>
                      <span class="feature-tag">‚ôø Accessible</span>
                    </div>
                  </div>
                </details>
              </div>
            </div>
          </div>
          
          <!-- Live Preview Controls -->
          <div class="live-preview-controls" id="livePreviewControls" style="display: none;">
            <div class="preview-bar">
              <span class="preview-label">Live Preview:</span>
              <span class="preview-url" id="previewUrl"></span>
              <button class="select-element-btn" id="selectForEdit">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="11" cy="11" r="8"/>
                  <path d="m21 21-4.35-4.35"/>
                </svg>
                Select to Edit
              </button>
            </div>
          </div>
          
          <!-- Chat Input -->
          <div class="webdev-input-area">
            <textarea id="webdevInput" 
                      placeholder="Describe the website you want to build... (e.g., 'Create a landing page for a fitness app with hero section, features, pricing, and footer')" 
                      rows="3"></textarea>
            <button class="send-btn" id="sendWebdevMessage">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="22" y1="2" x2="11" y2="13"/>
                <polygon points="22 2 15 22 11 13 2 9 22 2"/>
              </svg>
              Build
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Memory Section -->
    <div class="main-tab-content" id="memorySection" style="display: none; flex-direction: column; flex: 1; overflow: hidden;">
      <div class="memory-container">
        <!-- Memory Header -->
        <div class="memory-header">
          <h2>üß† Memory Bank</h2>
          <div class="memory-actions">
            <button class="add-memory-btn" id="addMemoryBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14M5 12h14"/>
              </svg>
              Add Memory
            </button>
            <button class="import-memory-btn" id="importMemoryBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
              Import
            </button>
          </div>
        </div>
        
        <!-- Memory Introduction -->
        <div class="memory-intro">
          <div class="memory-intro-content">
            <div class="intro-text">
              <h3>Your Personal Knowledge Base</h3>
              <p>Memory allows you to store, organize, and instantly recall important information. Think of it as your AI-powered second brain that remembers everything for you.</p>
            </div>
            
            <div class="memory-use-cases">
              <h4>Perfect for:</h4>
              <div class="use-cases-grid">
                <div class="use-case">
                  <div class="use-case-icon">üìù</div>
                  <div class="use-case-content">
                    <strong>Quick Notes</strong>
                    <span>Save important snippets while browsing</span>
                  </div>
                </div>
                <div class="use-case">
                  <div class="use-case-icon">üîë</div>
                  <div class="use-case-content">
                    <strong>Login Details</strong>
                    <span>Remember account info and preferences</span>
                  </div>
                </div>
                <div class="use-case">
                  <div class="use-case-icon">üõí</div>
                  <div class="use-case-content">
                    <strong>Shopping Lists</strong>
                    <span>Track what you're looking for</span>
                  </div>
                </div>
                <div class="use-case">
                  <div class="use-case-icon">üìö</div>
                  <div class="use-case-content">
                    <strong>Study Notes</strong>
                    <span>Organize learning materials</span>
                  </div>
                </div>
                <div class="use-case">
                  <div class="use-case-icon">üíº</div>
                  <div class="use-case-content">
                    <strong>Work References</strong>
                    <span>Store project details and resources</span>
                  </div>
                </div>
                <div class="use-case">
                  <div class="use-case-icon">üéØ</div>
                  <div class="use-case-content">
                    <strong>Personal Goals</strong>
                    <span>Track objectives and progress</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="memory-features">
              <h4>Key Features:</h4>
              <div class="features-list">
                <div class="feature-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                  </svg>
                  <span><strong>Smart Search:</strong> Find memories instantly with intelligent search</span>
                </div>
                <div class="feature-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                  </svg>
                  <span><strong>Categories & Tags:</strong> Organize with custom labels and filters</span>
                </div>
                <div class="feature-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                  </svg>
                  <span><strong>Private & Secure:</strong> All data stored locally in your browser</span>
                </div>
                <div class="feature-item">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                  </svg>
                  <span><strong>Import/Export:</strong> Backup and sync your memories</span>
                </div>
              </div>
            </div>
            
            <div class="quick-start">
              <div class="quick-start-content">
                <strong>üí° Quick Start:</strong> Click "Add Memory" to create your first memory, or try importing existing notes to get started instantly.
              </div>
            </div>
          </div>
        </div>
        
        <!-- Memory Search -->
        <div class="memory-search-container">
          <div class="search-wrapper">
            <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
            <input type="text" id="memorySearch" placeholder="Search memories..." class="memory-search-input">
          </div>
          <div class="memory-filters">
            <button class="filter-btn active" data-filter="all">All</button>
            <button class="filter-btn" data-filter="personal">Personal</button>
            <button class="filter-btn" data-filter="work">Work</button>
            <button class="filter-btn" data-filter="ideas">Ideas</button>
            <button class="filter-btn" data-filter="tasks">Tasks</button>
          </div>
        </div>
        
        <!-- Memory List -->
        <div class="memory-content-area">
          <div class="memory-list" id="memoryList">
            <!-- Memory items will be populated here -->
            <div class="memory-empty-state" id="memoryEmptyState">
              <div class="empty-icon">üß†</div>
              <h3>No memories yet</h3>
              <p>Start building your personal memory bank by adding important information, notes, and insights.</p>
              <button class="add-first-memory-btn" onclick="document.getElementById('addMemoryBtn').click()">
                Add Your First Memory
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Tools Section -->
    <div class="main-tab-content" id="toolsSection" style="display: none; flex-direction: column; flex: 1; overflow: hidden;">
      <div class="tools-container">
        <!-- Tools Header -->
        <div class="tools-header">
          <h2>üõ†Ô∏è Tools</h2>
          <p class="tools-subtitle">Productivity tools to enhance your workflow</p>
        </div>
        
        <!-- Tools Grid -->
        <div class="tools-content">
          <div class="tools-grid">
            
            <!-- Craft Mail Tool -->
            <div class="tool-card" data-tool="craft-mail">
              <div class="tool-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <polyline points="22,6 12,13 2,6"/>
                </svg>
              </div>
              <div class="tool-content">
                <h3>Craft Mail</h3>
                <p>AI-powered email composer with smart templates and professional formatting</p>
                <div class="tool-features">
                  <span class="feature-tag">Smart Templates</span>
                  <span class="feature-tag">AI Writing</span>
                  <span class="feature-tag">Professional</span>
                </div>
              </div>
              <button class="tool-launch-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M7 17L17 7"/>
                  <path d="M7 7h10v10"/>
                </svg>
                Launch
              </button>
            </div>
            
            <!-- Placeholder for future tools -->
            <div class="tool-card placeholder">
              <div class="tool-icon placeholder-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <line x1="12" y1="8" x2="12" y2="16"/>
                  <line x1="8" y1="12" x2="16" y2="12"/>
                </svg>
              </div>
              <div class="tool-content">
                <h3>More Tools Coming</h3>
                <p>Additional productivity tools will be added here in future updates</p>
              </div>
            </div>
            
          </div>
        </div>
      </div>
      
      <!-- Craft Mail Modal/Overlay -->
      <div class="craft-mail-overlay" id="craftMailOverlay" style="display: none;">
        <div class="craft-mail-modal">
          <div class="craft-mail-header">
            <h3>‚ú® Craft Mail</h3>
            <button class="close-craft-mail" id="closeCraftMail">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
            </button>
          </div>
          <div class="craft-mail-content">
            <!-- The existing mail compose content will be moved here -->
            <div id="craftMailContent">
              <!-- Content will be dynamically loaded -->
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Settings Section -->
    <div class="main-tab-content" id="settingsSection" style="display: none; flex-direction: column; flex: 1; overflow: hidden;">
      <div class="settings-container">
        <!-- Settings Header -->
        <div class="settings-header">
          <h2>‚öôÔ∏è Settings</h2>
          <button class="save-settings-btn" id="saveSettingsBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
              <polyline points="17 21 17 13 7 13 7 21"/>
              <polyline points="7 3 7 8 15 8"/>
            </svg>
            Save Settings
          </button>
        </div>
        
        <!-- Settings Content -->
        <div class="settings-content">
          
          <!-- LLM Provider Section -->
          <div class="settings-section">
            <h3>ü§ñ LLM Provider Configuration</h3>
            
            <div class="setting-group">
              <label class="setting-label">Primary LLM Provider</label>
              <select id="primaryLLMProvider" class="setting-select">
                <option value="chrome-ai">Chrome Built-in AI (Prompt API)</option>
                <option value="openai">OpenAI (GPT-4)</option>
                <option value="anthropic">Anthropic (Claude)</option>
                <option value="google">Google AI (Gemini Pro)</option>
                <option value="local">Local LLM (Ollama)</option>
                <option value="custom">Custom API</option>
              </select>
            </div>
            
            <div class="api-key-section" id="apiKeySection" style="display: none;">
              <label class="setting-label">API Key</label>
              <input type="password" id="apiKey" class="setting-input" placeholder="Enter your API key">
              <small class="setting-hint">Your API key is stored locally and never sent to our servers</small>
            </div>
            
            <div class="custom-api-section" id="customApiSection" style="display: none;">
              <label class="setting-label">API Endpoint</label>
              <input type="url" id="apiEndpoint" class="setting-input" placeholder="https://api.example.com/v1">
            </div>
          </div>
          
          <!-- Task-Specific LLM Selection -->
          <div class="settings-section">
            <h3>üìã Task-Specific Model Selection</h3>
            
            <div class="task-llm-grid">
              <!-- Chat Task -->
              <div class="task-llm-item">
                <label class="task-label">
                  <span class="task-icon">üí¨</span>
                  <span>Chat Assistant</span>
                </label>
                <select id="chatLLM" class="task-select">
                  <option value="default">Use Primary Provider</option>
                  <option value="chrome-ai">Chrome AI</option>
                  <option value="gpt-4">GPT-4</option>
                  <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                  <option value="claude-3">Claude 3</option>
                  <option value="gemini-pro">Gemini Pro</option>
                </select>
              </div>
              
              <!-- Email Task -->
              <div class="task-llm-item">
                <label class="task-label">
                  <span class="task-icon">‚úâÔ∏è</span>
                  <span>Email Composition</span>
                </label>
                <select id="emailLLM" class="task-select">
                  <option value="default">Use Primary Provider</option>
                  <option value="chrome-ai">Chrome AI</option>
                  <option value="gpt-4">GPT-4</option>
                  <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                  <option value="claude-3">Claude 3</option>
                  <option value="gemini-pro">Gemini Pro</option>
                </select>
              </div>
              
              <!-- Research Agent -->
              <div class="task-llm-item">
                <label class="task-label">
                  <span class="task-icon">üîç</span>
                  <span>Research Agent</span>
                </label>
                <select id="researchLLM" class="task-select">
                  <option value="default">Use Primary Provider</option>
                  <option value="chrome-ai">Chrome AI</option>
                  <option value="gpt-4">GPT-4</option>
                  <option value="claude-3">Claude 3</option>
                  <option value="gemini-pro">Gemini Pro</option>
                </select>
              </div>
              
              <!-- Code Agent -->
              <div class="task-llm-item">
                <label class="task-label">
                  <span class="task-icon">üíª</span>
                  <span>Code Agent</span>
                </label>
                <select id="codeLLM" class="task-select">
                  <option value="default">Use Primary Provider</option>
                  <option value="chrome-ai">Chrome AI</option>
                  <option value="gpt-4">GPT-4</option>
                  <option value="codellama">Code Llama</option>
                  <option value="starcoder">StarCoder</option>
                </select>
              </div>
              
              <!-- Writing Agent -->
              <div class="task-llm-item">
                <label class="task-label">
                  <span class="task-icon">‚úçÔ∏è</span>
                  <span>Writing Agent</span>
                </label>
                <select id="writingLLM" class="task-select">
                  <option value="default">Use Primary Provider</option>
                  <option value="chrome-ai">Chrome AI</option>
                  <option value="gpt-4">GPT-4</option>
                  <option value="claude-3">Claude 3</option>
                  <option value="gemini-pro">Gemini Pro</option>
                </select>
              </div>
              
              <!-- Analysis Agent -->
              <div class="task-llm-item">
                <label class="task-label">
                  <span class="task-icon">üìä</span>
                  <span>Analysis Agent</span>
                </label>
                <select id="analysisLLM" class="task-select">
                  <option value="default">Use Primary Provider</option>
                  <option value="chrome-ai">Chrome AI</option>
                  <option value="gpt-4">GPT-4</option>
                  <option value="claude-3">Claude 3</option>
                  <option value="gemini-pro">Gemini Pro</option>
                </select>
              </div>
            </div>
          </div>
          
          <!-- Advanced Settings -->
          <div class="settings-section">
            <h3>‚ö° Advanced Settings</h3>
            
            <div class="setting-group">
              <label class="setting-label">
                <input type="checkbox" id="enableFallback" checked>
                <span>Enable automatic fallback to Chrome Built-in AI when primary fails</span>
              </label>
            </div>
            
            <div class="setting-group">
              <label class="setting-label">
                <input type="checkbox" id="saveHistory" checked>
                <span>Save conversation history</span>
              </label>
            </div>
            
            <div class="setting-group">
              <label class="setting-label">
                <input type="checkbox" id="showApiStatus" checked>
                <span>Show API status in interface</span>
              </label>
            </div>
            
            <div class="setting-group">
              <label class="setting-label">Temperature (Creativity)</label>
              <div class="slider-container">
                <input type="range" id="temperature" min="0" max="100" value="70" class="setting-slider">
                <span class="slider-value" id="temperatureValue">0.7</span>
              </div>
              <small class="setting-hint">Lower = More focused, Higher = More creative</small>
            </div>
            
            <div class="setting-group">
              <label class="setting-label">Max Tokens (Response Length)</label>
              <input type="number" id="maxTokens" class="setting-input" value="2048" min="100" max="4096">
              <small class="setting-hint">Maximum length of AI responses</small>
            </div>
          </div>
          
          <!-- About Section -->
          <div class="settings-section">
            <h3>‚ÑπÔ∏è About</h3>
            <div class="about-content">
              <p><strong>AI Browser Agent Extension</strong></p>
              <p>Version: 1.0.0</p>
              <p>A powerful Chrome extension with multi-LLM support for chat, email, and intelligent agents.</p>
              <div class="about-links">
                <a href="#" id="resetSettings">Reset All Settings</a>
                <a href="#" id="exportSettings">Export Settings</a>
                <a href="#" id="importSettings">Import Settings</a>
              </div>
            </div>
          </div>
          
        </div>
      </div>
    </div>
  </div>

  <script src="scripts/functions.js"></script>
  <script src="scripts/ai-apis.js"></script>
  <script src="scripts/sidepanel.js"></script>
  <script src="scripts/mail-compose.js"></script>
  <script src="scripts/agent.js"></script>
  <script src="scripts/webdev.js"></script>
  <script src="scripts/memory.js"></script>
  <script src="scripts/settings.js"></script>
</body>
</html>
